{"version":3,"sources":["@wordpress/block-editor/src/components/global-styles/filters-panel.js"],"names":["__experimentalToolsPanel","ToolsPanel","__experimentalToolsPanelItem","ToolsPanelItem","__experimentalVStack","VStack","DuotonePicker","__","useCallback","useMemo","getValueFromVariable","immutableSet","EMPTY_ARRAY","useMultiOriginColorPresets","settings","presetSetting","defaultSetting","disableDefault","color","userPresets","custom","themePresets","theme","defaultPresets","default","useHasFiltersPanel","hasDuotone","useHasDuotoneControl","customDuotone","defaultDuotone","FiltersToolsPanel","resetAllFilter","onChange","value","panelId","children","resetAll","updatedValue","DEFAULT_CONTROLS","duotone","FiltersPanel","as","Wrapper","inheritedValue","defaultControls","decodeValue","rawValue","hasDuotoneEnabled","duotonePalette","colorPalette","filter","setDuotone","newValue","duotonePreset","find","colors","settedValue","slug","resetDuotone","undefined","previousValue"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\t__experimentalToolsPanel as ToolsPanel,\n\t__experimentalToolsPanelItem as ToolsPanelItem,\n\t__experimentalVStack as VStack,\n\tDuotonePicker,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useCallback, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { getValueFromVariable } from './utils';\nimport { immutableSet } from '../../utils/object';\n\nconst EMPTY_ARRAY = [];\nfunction useMultiOriginColorPresets(\n\tsettings,\n\t{ presetSetting, defaultSetting }\n) {\n\tconst disableDefault = ! settings?.color?.[ defaultSetting ];\n\tconst userPresets =\n\t\tsettings?.color?.[ presetSetting ]?.custom || EMPTY_ARRAY;\n\tconst themePresets =\n\t\tsettings?.color?.[ presetSetting ]?.theme || EMPTY_ARRAY;\n\tconst defaultPresets =\n\t\tsettings?.color?.[ presetSetting ]?.default || EMPTY_ARRAY;\n\treturn useMemo(\n\t\t() => [\n\t\t\t...userPresets,\n\t\t\t...themePresets,\n\t\t\t...( disableDefault ? EMPTY_ARRAY : defaultPresets ),\n\t\t],\n\t\t[ disableDefault, userPresets, themePresets, defaultPresets ]\n\t);\n}\n\nexport function useHasFiltersPanel( settings ) {\n\tconst hasDuotone = useHasDuotoneControl( settings );\n\n\treturn hasDuotone;\n}\n\nfunction useHasDuotoneControl( settings ) {\n\treturn settings.color.customDuotone || settings.color.defaultDuotone;\n}\n\nfunction FiltersToolsPanel( {\n\tresetAllFilter,\n\tonChange,\n\tvalue,\n\tpanelId,\n\tchildren,\n} ) {\n\tconst resetAll = () => {\n\t\tconst updatedValue = resetAllFilter( value );\n\t\tonChange( updatedValue );\n\t};\n\n\treturn (\n\t\t<ToolsPanel\n\t\t\tlabel={ __( 'Filters' ) }\n\t\t\tresetAll={ resetAll }\n\t\t\tpanelId={ panelId }\n\t\t>\n\t\t\t{ children }\n\t\t</ToolsPanel>\n\t);\n}\n\nconst DEFAULT_CONTROLS = {\n\tduotone: true,\n};\n\nexport default function FiltersPanel( {\n\tas: Wrapper = FiltersToolsPanel,\n\tvalue,\n\tonChange,\n\tinheritedValue = value,\n\tsettings,\n\tpanelId,\n\tdefaultControls = DEFAULT_CONTROLS,\n} ) {\n\tconst decodeValue = ( rawValue ) =>\n\t\tgetValueFromVariable( { settings }, '', rawValue );\n\n\t// Duotone\n\tconst hasDuotoneEnabled = useHasDuotoneControl( settings );\n\tconst duotonePalette = useMultiOriginColorPresets( settings, {\n\t\tpresetSetting: 'duotone',\n\t\tdefaultSetting: 'defaultDuotone',\n\t} );\n\tconst colorPalette = useMultiOriginColorPresets( settings, {\n\t\tpresetSetting: 'palette',\n\t\tdefaultSetting: 'defaultPalette',\n\t} );\n\tconst duotone = decodeValue( inheritedValue?.filter?.duotone );\n\tconst setDuotone = ( newValue ) => {\n\t\tconst duotonePreset = duotonePalette.find( ( { colors } ) => {\n\t\t\treturn colors === newValue;\n\t\t} );\n\t\tconst settedValue = duotonePreset\n\t\t\t? `var:preset|duotone|${ duotonePreset.slug }`\n\t\t\t: newValue;\n\t\tonChange( immutableSet( value, [ 'filter', 'duotone' ], settedValue ) );\n\t};\n\tconst hasDuotone = () => !! value?.filter?.duotone;\n\tconst resetDuotone = () => setDuotone( undefined );\n\n\tconst resetAllFilter = useCallback( ( previousValue ) => {\n\t\treturn {\n\t\t\t...previousValue,\n\t\t\tfilter: {\n\t\t\t\t...previousValue.filter,\n\t\t\t\tduotone: undefined,\n\t\t\t},\n\t\t};\n\t}, [] );\n\n\treturn (\n\t\t<Wrapper\n\t\t\tresetAllFilter={ resetAllFilter }\n\t\t\tvalue={ value }\n\t\t\tonChange={ onChange }\n\t\t\tpanelId={ panelId }\n\t\t>\n\t\t\t{ hasDuotoneEnabled && (\n\t\t\t\t<ToolsPanelItem\n\t\t\t\t\tlabel={ __( 'Duotone' ) }\n\t\t\t\t\thasValue={ hasDuotone }\n\t\t\t\t\tonDeselect={ resetDuotone }\n\t\t\t\t\tisShownByDefault={ defaultControls.duotone }\n\t\t\t\t\tpanelId={ panelId }\n\t\t\t\t>\n\t\t\t\t\t<VStack>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t'Create a two-tone color effect without losing your original image.'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<DuotonePicker\n\t\t\t\t\t\t\tcolorPalette={ colorPalette }\n\t\t\t\t\t\t\tduotonePalette={ duotonePalette }\n\t\t\t\t\t\t\tdisableCustomColors={ true }\n\t\t\t\t\t\t\tdisableCustomDuotone={ true }\n\t\t\t\t\t\t\tvalue={ duotone }\n\t\t\t\t\t\t\tonChange={ setDuotone }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</VStack>\n\t\t\t\t</ToolsPanelItem>\n\t\t\t) }\n\t\t</Wrapper>\n\t);\n}\n"]}